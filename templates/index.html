<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ðŸ’Š BotiquÃ­n Inteligente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">
<div class="container mt-5">
    <h1 class="text-center mb-4">ðŸ’Š BotiquÃ­n Inteligente</h1>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Bienvenido, {{ usuario }}</h3>
    <a href="/logout" class="btn btn-danger">Cerrar sesiÃ³n</a>
</div>


    <form action="/agregar" method="POST" class="mb-4">
    <div class="row">
        <div class="col-md-3">
            <input type="text" name="nombre" placeholder="Nombre" class="form-control" required>
        </div>
        <div class="col-md-2">
            <input type="number" name="cantidad_total" placeholder="Cantidad total" class="form-control" required>
        </div>
        <div class="col-md-2">
            <input type="number" name="consumo_diario" placeholder="Consumo diario" class="form-control" required>
        </div>
        <div class="col-md-3">
            <select name="tipo" class="form-select" required>
                <option value="">Seleccionar tipo</option>
                <option value="pastilla">Pastilla</option>
                <option value="inyeccion">InyecciÃ³n</option>
            </select>
        </div>
        <div class="col-md-2">
            <button class="btn btn-success w-100">Agregar</button>
        </div>
    </div>
</form>


    {% if alertas %}
  <div class="container mt-3">
    {% for alerta in alertas %}
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
        {{ alerta }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}

{% with messages = get_flashed_messages(with_categories=true) %}
      {% for category, message in messages %}
        <div class="alert alert-{{category}}">{{message}}</div>
      {% endfor %}
    {% endwith %}

     <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Total</th>
                <th>Consumo diario</th>
                <th>Restante</th>
                <th>AcciÃ³n</th>
            </tr>
        </thead>
        <tbody>
        {% for m in medicamentos %}
            <tr>
                <td>{{ m.nombre }}</td>
                <td>{{ m.cantidad_total }}</td>
                <td>{{ m.consumo_diario }}</td>
                <td>{{ m.cantidad_restante }}</td>
                <td>
                    <form action="/consumir/{{ m.id }}" method="POST">
                        <button class="btn btn-warning btn-sm">Consumir</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</body>
</html>
